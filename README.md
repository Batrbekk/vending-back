# ü§ñ –°–∏—Å—Ç–µ–º–∞ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –≤–µ–Ω–¥–∏–Ω–≥–æ–≤—ã–º–∏ –∞–≤—Ç–æ–º–∞—Ç–∞–º–∏ - MVP

–ü–æ–ª–Ω–æ—Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–∞—è backend —Å–∏—Å—Ç–µ–º–∞ –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Å–µ—Ç—å—é –≤–µ–Ω–¥–∏–Ω–≥–æ–≤—ã—Ö –∞–≤—Ç–æ–º–∞—Ç–æ–≤, –≤–∫–ª—é—á–∞—é—â–∞—è —É—á—ë—Ç –æ—Å—Ç–∞—Ç–∫–æ–≤, —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ø–æ–ª–Ω–µ–Ω–∏—è–º–∏, —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—é –ø—Ä–æ–¥–∞–∂ –∏ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Å—Ç–∞—Ç—É—Å–æ–≤.

## üìã –°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ

- [–í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏](#-–≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏)
- [–¢–µ—Ö–Ω–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–π —Å—Ç–µ–∫](#-—Ç–µ—Ö–Ω–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–π-—Å—Ç–µ–∫)
- [–ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç](#-–±—ã—Å—Ç—Ä—ã–π-—Å—Ç–∞—Ä—Ç)
- [–°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞](#-—Å—Ç—Ä—É–∫—Ç—É—Ä–∞-–ø—Ä–æ–µ–∫—Ç–∞)
- [API –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è](#-api-–¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è)
- [–ú–æ–¥–µ–ª–∏ –¥–∞–Ω–Ω—ã—Ö](#-–º–æ–¥–µ–ª–∏-–¥–∞–Ω–Ω—ã—Ö)
- [–†–æ–ª–∏ –∏ –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞](#-—Ä–æ–ª–∏-–∏-–ø—Ä–∞–≤–∞-–¥–æ—Å—Ç—É–ø–∞)
- [–ë–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞](#-–±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞)
- [Device Gateway](#-device-gateway)
- [–†–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ](#-—Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ)

## üöÄ –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

### ‚úÖ –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ –≤ MVP v1.0:

- **JWT –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è** —Å —Ä–æ–ª–µ–≤–æ–π –º–æ–¥–µ–ª—å—é (ADMIN/MANAGER)
- **CRUD –∞–≤—Ç–æ–º–∞—Ç–æ–≤** —Å —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ–º –ª–æ–∫–∞—Ü–∏—è–º–∏ –∏ –Ω–∞–∑–Ω–∞—á–µ–Ω–∏–µ–º –º–µ–Ω–µ–¥–∂–µ—Ä–æ–≤
- **–°–∏—Å—Ç–µ–º–∞ –ø–æ–ø–æ–ª–Ω–µ–Ω–∏–π** —Å –∫–æ–Ω—Ç—Ä–æ–ª–µ–º —Å–µ—Å—Å–∏–π –∏ –≤–∞–ª–∏–¥–∞—Ü–∏–µ–π –æ—Å—Ç–∞—Ç–∫–æ–≤
- **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞–º–∏** –∞–≤—Ç–æ–º–∞—Ç–æ–≤ (WORKING/LOW_STOCK/OUT_OF_STOCK/IN_SERVICE/ERROR)
- **–°–∏—Å—Ç–µ–º–∞ –∞–ª–µ—Ä—Ç–æ–≤** —Å debounce –º–µ—Ö–∞–Ω–∏–∑–º–æ–º (–Ω–µ —á–∞—â–µ —Ä–∞–∑–∞ –≤ 30 –º–∏–Ω—É—Ç)
- **–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –ø—Ä–æ–¥–∞–∂** —Å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–º –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ–º –æ—Å—Ç–∞—Ç–∫–æ–≤
- **Device Gateway API** –¥–ª—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ —Å –∂–µ–ª–µ–∑–æ–º –∞–≤—Ç–æ–º–∞—Ç–æ–≤
- **–¢–µ–ª–µ–º–µ—Ç—Ä–∏—è –∏ heartbeat** –æ—Ç —É—Å—Ç—Ä–æ–π—Å—Ç–≤
- **–î–µ—Ç–∞–ª—å–Ω—ã–π –∞—É–¥–∏—Ç** –≤—Å–µ—Ö –æ–ø–µ—Ä–∞—Ü–∏–π
- **Seed –¥–∞–Ω–Ω—ã–µ** –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

### ‚è≥ –ü–ª–∞–Ω–∏—Ä—É–µ—Ç—Å—è –≤ v1.1:

- WebSocket real-time –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è
- –ö–∞—Ä—Ç–∞ –ª–æ–∫–∞—Ü–∏–π —Å –≥–µ–æ–ø–æ–∑–∏—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ–º
- Email/Telegram —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
- –†–∞—Å—à–∏—Ä–µ–Ω–Ω–∞—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∞ –∏ –æ—Ç—á—ë—Ç—ã

## üõ† –¢–µ—Ö–Ω–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–π —Å—Ç–µ–∫

- **Framework**: Next.js 15 (App Router)
- **Language**: TypeScript
- **Database**: MongoDB + Mongoose ODM
- **Validation**: Zod
- **Authentication**: JWT (custom implementation)
- **Password Hashing**: bcrypt
- **Real-time**: Socket.io (–≥–æ—Ç–æ–≤–æ –∫ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏)
- **Styling**: Tailwind CSS
- **Development**: TSX –¥–ª—è —Å–∫—Ä–∏–ø—Ç–æ–≤

## ‚ö° –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### 1. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

```bash
yarn install
```

### 2. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –æ–∫—Ä—É–∂–µ–Ω–∏—è

–°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª `.env.local` –Ω–∞ –æ—Å–Ω–æ–≤–µ `.env.example`:

```env
# MongoDB
MONGODB_URI=mongodb://localhost:27017/vending-machines
MONGODB_DB_NAME=vending-machines

# JWT Authentication  
JWT_SECRET=your-super-secret-jwt-key-change-in-production
JWT_EXPIRES_IN=7d

# Server Configuration
PORT=3000
NODE_ENV=development

# Device API
DEVICE_API_SECRET=device-gateway-secret-key

# Admin User (–¥–ª—è seed –¥–∞–Ω–Ω—ã—Ö)
ADMIN_EMAIL=admin@vendingapp.kz
ADMIN_PASSWORD=admin123
ADMIN_NAME=System Administrator
```

### 3. –ó–∞–ø—É—Å–∫ MongoDB

```bash
# –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ MongoDB –ª–æ–∫–∞–ª—å–Ω–æ –∏–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ Docker
docker run --name vending-mongo -p 27017:27017 -d mongo:latest
```

### 4. –ó–∞–ø–æ–ª–Ω–µ–Ω–∏–µ —Ç–µ—Å—Ç–æ–≤—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏

```bash
yarn seed
```

–≠—Ç–æ —Å–æ–∑–¥–∞—Å—Ç:
- 3 –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (1 –∞–¥–º–∏–Ω, 2 –º–µ–Ω–µ–¥–∂–µ—Ä–∞)
- 5 –ª–æ–∫–∞—Ü–∏–π –≤ –ê–ª–º–∞—Ç—ã
- 8 –∞–≤—Ç–æ–º–∞—Ç–æ–≤ —Å —Ä–∞–∑–Ω—ã–º–∏ –æ—Å—Ç–∞—Ç–∫–∞–º–∏
- 500 –ø—Ä–æ–¥–∞–∂ –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 30 –¥–Ω–µ–π
- 50 –∑–∞–ø–∏—Å–µ–π –ø–æ–ø–æ–ª–Ω–µ–Ω–∏–π
- –ê–ª–µ—Ä—Ç—ã –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–æ–≤ —Å –Ω–∏–∑–∫–∏–º–∏ –æ—Å—Ç–∞—Ç–∫–∞–º–∏

### 5. –ó–∞–ø—É—Å–∫ —Å–µ—Ä–≤–µ—Ä–∞

```bash
yarn dev
```

–°–∏—Å—Ç–µ–º–∞ –±—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–Ω–∞ –ø–æ –∞–¥—Ä–µ—Å—É: http://localhost:3000

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
‚îú‚îÄ‚îÄ app/
‚îÇ   ‚îú‚îÄ‚îÄ api/                    # API Routes (Next.js App Router)
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ auth/              # –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ users/             # –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏  
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ locations/         # –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ª–æ–∫–∞—Ü–∏—è–º–∏
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ machines/          # –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∞–≤—Ç–æ–º–∞—Ç–∞–º–∏
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ device/            # Device Gateway API
‚îÇ   ‚îú‚îÄ‚îÄ globals.css           # –ì–ª–æ–±–∞–ª—å–Ω—ã–µ —Å—Ç–∏–ª–∏
‚îÇ   ‚îú‚îÄ‚îÄ layout.tsx           # –ö–æ—Ä–Ω–µ–≤–æ–π layout
‚îÇ   ‚îî‚îÄ‚îÄ page.tsx            # –ì–ª–∞–≤–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞
‚îú‚îÄ‚îÄ entities/               # Mongoose –º–æ–¥–µ–ª–∏
‚îÇ   ‚îú‚îÄ‚îÄ User.ts
‚îÇ   ‚îú‚îÄ‚îÄ Location.ts
‚îÇ   ‚îú‚îÄ‚îÄ VendingMachine.ts
‚îÇ   ‚îú‚îÄ‚îÄ RefillLog.ts
‚îÇ   ‚îú‚îÄ‚îÄ Sale.ts
‚îÇ   ‚îú‚îÄ‚îÄ Alert.ts
‚îÇ   ‚îî‚îÄ‚îÄ Device.ts
‚îú‚îÄ‚îÄ lib/                   # –£—Ç–∏–ª–∏—Ç—ã –∏ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏
‚îÇ   ‚îú‚îÄ‚îÄ auth/             # JWT –∏ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è
‚îÇ   ‚îú‚îÄ‚îÄ database/         # –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ MongoDB
‚îÇ   ‚îî‚îÄ‚îÄ validation/       # Zod —Å—Ö–µ–º—ã –≤–∞–ª–∏–¥–∞—Ü–∏–∏
‚îú‚îÄ‚îÄ scripts/              # –°–ª—É–∂–µ–±–Ω—ã–µ —Å–∫—Ä–∏–ø—Ç—ã
‚îÇ   ‚îî‚îÄ‚îÄ seed.ts          # –ó–∞–ø–æ–ª–Ω–µ–Ω–∏–µ —Ç–µ—Å—Ç–æ–≤—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏
‚îî‚îÄ‚îÄ types/               # TypeScript —Ç–∏–ø—ã
    ‚îî‚îÄ‚îÄ index.ts
```

## üîå API –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

### –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è

| –ú–µ—Ç–æ–¥ | Endpoint | –û–ø–∏—Å–∞–Ω–∏–µ |
|-------|----------|----------|
| POST | `/api/auth/login` | –í—Ö–æ–¥ –≤ —Å–∏—Å—Ç–µ–º—É |
| POST | `/api/auth/logout` | –í—ã—Ö–æ–¥ –∏–∑ —Å–∏—Å—Ç–µ–º—ã |
| GET | `/api/auth/me` | –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Ç–µ–∫—É—â–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ |

### –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ (—Ç–æ–ª—å–∫–æ ADMIN)

| –ú–µ—Ç–æ–¥ | Endpoint | –û–ø–∏—Å–∞–Ω–∏–µ |
|-------|----------|----------|
| GET | `/api/users` | –°–ø–∏—Å–æ–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π |
| POST | `/api/users` | –°–æ–∑–¥–∞–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è |
| GET | `/api/users/:id` | –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ |
| PATCH | `/api/users/:id` | –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è |
| DELETE | `/api/users/:id` | –î–µ–∞–∫—Ç–∏–≤–∞—Ü–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è |

### –õ–æ–∫–∞—Ü–∏–∏

| –ú–µ—Ç–æ–¥ | Endpoint | –û–ø–∏—Å–∞–Ω–∏–µ |
|-------|----------|----------|
| GET | `/api/locations` | –°–ø–∏—Å–æ–∫ –ª–æ–∫–∞—Ü–∏–π |
| POST | `/api/locations` | –°–æ–∑–¥–∞–Ω–∏–µ –ª–æ–∫–∞—Ü–∏–∏ (ADMIN) |

### –ê–≤—Ç–æ–º–∞—Ç—ã

| –ú–µ—Ç–æ–¥ | Endpoint | –û–ø–∏—Å–∞–Ω–∏–µ |
|-------|----------|----------|
| GET | `/api/machines` | –°–ø–∏—Å–æ–∫ –∞–≤—Ç–æ–º–∞—Ç–æ–≤ |
| POST | `/api/machines` | –°–æ–∑–¥–∞–Ω–∏–µ –∞–≤—Ç–æ–º–∞—Ç–∞ (ADMIN) |
| GET | `/api/machines/:id` | –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ–± –∞–≤—Ç–æ–º–∞—Ç–µ |
| PATCH | `/api/machines/:id` | –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∞–≤—Ç–æ–º–∞—Ç–∞ (ADMIN) |
| DELETE | `/api/machines/:id` | –£–¥–∞–ª–µ–Ω–∏–µ –∞–≤—Ç–æ–º–∞—Ç–∞ (ADMIN) |
| POST | `/api/machines/:id/assign` | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ –º–µ–Ω–µ–¥–∂–µ—Ä–∞ (ADMIN) |
| POST | `/api/machines/:id/refill/start` | –ù–∞—á–∞–ª–æ –ø–æ–ø–æ–ª–Ω–µ–Ω–∏—è |
| POST | `/api/machines/:id/refill/finish` | –ó–∞–≤–µ—Ä—à–µ–Ω–∏–µ –ø–æ–ø–æ–ª–Ω–µ–Ω–∏—è |
| GET | `/api/machines/:id/refills` | –ò—Å—Ç–æ—Ä–∏—è –ø–æ–ø–æ–ª–Ω–µ–Ω–∏–π |

### Device Gateway

| –ú–µ—Ç–æ–¥ | Endpoint | –û–ø–∏—Å–∞–Ω–∏–µ |
|-------|----------|----------|
| POST | `/api/device/:machineId/heartbeat` | Heartbeat –æ—Ç —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ |
| POST | `/api/device/:machineId/telemetry` | –¢–µ–ª–µ–º–µ—Ç—Ä–∏—è (–æ—Å—Ç–∞—Ç–∫–∏, –æ—à–∏–±–∫–∏) |
| POST | `/api/device/:machineId/sale` | –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –ø—Ä–æ–¥–∞–∂–∏ |

## üóÑ –ú–æ–¥–µ–ª–∏ –¥–∞–Ω–Ω—ã—Ö

### User (–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å)
- `email` - —É–Ω–∏–∫–∞–ª—å–Ω—ã–π email
- `role` - ADMIN | MANAGER
- `name` - –∏–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- `phone` - —Ç–µ–ª–µ—Ñ–æ–Ω (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
- `isActive` - –∞–∫—Ç–∏–≤–µ–Ω –ª–∏ –∞–∫–∫–∞—É–Ω—Ç

### Location (–õ–æ–∫–∞—Ü–∏—è)
- `name` - –Ω–∞–∑–≤–∞–Ω–∏–µ –ª–æ–∫–∞—Ü–∏–∏
- `address` - –∞–¥—Ä–µ—Å
- `geo` - –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã (lat, lng)
- `timezone` - —á–∞—Å–æ–≤–æ–π –ø–æ—è—Å

### VendingMachine (–ê–≤—Ç–æ–º–∞—Ç)
- `machineId` - —É–Ω–∏–∫–∞–ª—å–Ω—ã–π ID –∞–≤—Ç–æ–º–∞—Ç–∞
- `locationId` - —Å—Å—ã–ª–∫–∞ –Ω–∞ –ª–æ–∫–∞—Ü–∏—é
- `capacity` - –≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 360)
- `stock` - —Ç–µ–∫—É—â–∏–π –æ—Å—Ç–∞—Ç–æ–∫
- `status` - WORKING | LOW_STOCK | OUT_OF_STOCK | IN_SERVICE | ERROR
- `assignedManagerId` - –Ω–∞–∑–Ω–∞—á–µ–Ω–Ω—ã–π –º–µ–Ω–µ–¥–∂–µ—Ä

### RefillLog (–ñ—É—Ä–Ω–∞–ª –ø–æ–ø–æ–ª–Ω–µ–Ω–∏–π)
- `machineId` - –∞–≤—Ç–æ–º–∞—Ç
- `managerId` - –º–µ–Ω–µ–¥–∂–µ—Ä
- `startedAt / finishedAt` - –≤—Ä–µ–º—è –Ω–∞—á–∞–ª–∞/–æ–∫–æ–Ω—á–∞–Ω–∏—è
- `before / added / after` - –æ—Å—Ç–∞—Ç–∫–∏ –¥–æ/–¥–æ–±–∞–≤–ª–µ–Ω–æ/–ø–æ—Å–ª–µ

### Sale (–ü—Ä–æ–¥–∞–∂–∞)
- `machineId` - –∞–≤—Ç–æ–º–∞—Ç
- `sku` - –∫–æ–¥ —Ç–æ–≤–∞—Ä–∞
- `price / qty / total` - —Ü–µ–Ω–∞/–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ/—Å—É–º–º–∞
- `paymentMethod` - —Å–ø–æ—Å–æ–± –æ–ø–ª–∞—Ç—ã

## üë• –†–æ–ª–∏ –∏ –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞

### ADMIN (–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä)
- –ü–æ–ª–Ω—ã–π –¥–æ—Å—Ç—É–ø –∫–æ –≤—Å–µ–º —Ñ—É–Ω–∫—Ü–∏—è–º
- –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏ –∏ –∞–≤—Ç–æ–º–∞—Ç–∞–º–∏
- –ü—Ä–æ—Å–º–æ—Ç—Ä —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –ø–æ –≤—Å–µ–º –∞–≤—Ç–æ–º–∞—Ç–∞–º
- –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ –º–µ–Ω–µ–¥–∂–µ—Ä–æ–≤

### MANAGER (–ú–µ–Ω–µ–¥–∂–µ—Ä)
- –ü—Ä–æ—Å–º–æ—Ç—Ä –Ω–∞–∑–Ω–∞—á–µ–Ω–Ω—ã—Ö –∞–≤—Ç–æ–º–∞—Ç–æ–≤
- –ü–æ–ø–æ–ª–Ω–µ–Ω–∏–µ –∞–≤—Ç–æ–º–∞—Ç–æ–≤
- –ü—Ä–æ—Å–º–æ—Ç—Ä –∏—Å—Ç–æ—Ä–∏–∏ —Å–≤–æ–∏—Ö –ø–æ–ø–æ–ª–Ω–µ–Ω–∏–π
- –ü–æ–ª—É—á–µ–Ω–∏–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –æ –Ω–∏–∑–∫–∏—Ö –æ—Å—Ç–∞—Ç–∫–∞—Ö

## ‚öôÔ∏è –ë–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞

### –°—Ç–∞—Ç—É—Å—ã –∞–≤—Ç–æ–º–∞—Ç–æ–≤

1. **WORKING** - –∞–≤—Ç–æ–º–∞—Ç —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–æ—Ä–º–∞–ª—å–Ω–æ (–æ—Å—Ç–∞—Ç–æ–∫ ‚â• 150)
2. **LOW_STOCK** - –Ω—É–∂–Ω–æ –ø–æ–ø–æ–ª–Ω–µ–Ω–∏–µ (–æ—Å—Ç–∞—Ç–æ–∫ < 150)
3. **OUT_OF_STOCK** - —Ç–æ–≤–∞—Ä—ã –∑–∞–∫–æ–Ω—á–∏–ª–∏—Å—å (–æ—Å—Ç–∞—Ç–æ–∫ = 0)
4. **IN_SERVICE** - –∞–≤—Ç–æ–º–∞—Ç –æ–±—Å–ª—É–∂–∏–≤–∞–µ—Ç—Å—è –º–µ–Ω–µ–¥–∂–µ—Ä–æ–º
5. **ERROR** - –æ—à–∏–±–∫–∞ —Å–∏—Å—Ç–µ–º—ã, —Ç—Ä–µ–±—É–µ—Ç –≤–º–µ—à–∞—Ç–µ–ª—å—Å—Ç–≤–∞

### –ü–æ—Ä–æ–≥–∏ –∏ –ø—Ä–∞–≤–∏–ª–∞

- **–ü–æ—Ä–æ–≥ –ø–æ–ø–æ–ª–Ω–µ–Ω–∏—è**: 150 –±–∞–Ω–æ–∫
- **–ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å**: 360 –±–∞–Ω–æ–∫ (–Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç—Å—è)
- **Debounce –∞–ª–µ—Ä—Ç–æ–≤**: –Ω–µ —á–∞—â–µ 1 —Ä–∞–∑–∞ –≤ 30 –º–∏–Ω—É—Ç
- **Drift detection**: —Ä–∞—Å—Ö–æ–∂–¥–µ–Ω–∏–µ > 5% –æ—Ç –≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏
- **Timeout —Å–µ—Å—Å–∏–∏**: 4 —á–∞—Å–∞ –Ω–∞ –ø–æ–ø–æ–ª–Ω–µ–Ω–∏–µ

### –ü—Ä–æ—Ü–µ—Å—Å –ø–æ–ø–æ–ª–Ω–µ–Ω–∏—è

1. –ú–µ–Ω–µ–¥–∂–µ—Ä –Ω–∞—á–∏–Ω–∞–µ—Ç —Å–µ—Å—Å–∏—é –ø–æ–ø–æ–ª–Ω–µ–Ω–∏—è
2. –ê–≤—Ç–æ–º–∞—Ç –ø–µ—Ä–µ—Ö–æ–¥–∏—Ç –≤ —Å—Ç–∞—Ç—É—Å `IN_SERVICE`
3. –ú–µ–Ω–µ–¥–∂–µ—Ä —É–∫–∞–∑—ã–≤–∞–µ—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –¥–æ–±–∞–≤–ª–µ–Ω–Ω—ã—Ö –±–∞–Ω–æ–∫
4. –°–∏—Å—Ç–µ–º–∞ —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ—Ç —Ñ–∞–∫—Ç–∏—á–µ—Å–∫–∏–π –æ—Å—Ç–∞—Ç–æ–∫ (–Ω–µ –±–æ–ª—å—à–µ capacity)
5. –°–æ–∑–¥–∞–µ—Ç—Å—è –∑–∞–ø–∏—Å—å –≤ –∂—É—Ä–Ω–∞–ª–µ –ø–æ–ø–æ–ª–Ω–µ–Ω–∏–π
6. –°—Ç–∞—Ç—É—Å –ø–µ—Ä–µ—Å—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏

## üì± Device Gateway

API –¥–ª—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ —Å —Ñ–∏–∑–∏—á–µ—Å–∫–∏–º–∏ –∞–≤—Ç–æ–º–∞—Ç–∞–º–∏:

### –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è —É—Å—Ç—Ä–æ–π—Å—Ç–≤
- –ö–∞–∂–¥—ã–π –∞–≤—Ç–æ–º–∞—Ç –∏–º–µ–µ—Ç —É–Ω–∏–∫–∞–ª—å–Ω—ã–π API –∫–ª—é—á
- –ö–ª—é—á –ø–µ—Ä–µ–¥–∞–µ—Ç—Å—è –≤ –∑–∞–≥–æ–ª–æ–≤–∫–µ `X-API-KEY`

### Heartbeat
- –£—Å—Ç—Ä–æ–π—Å—Ç–≤–æ –¥–æ–ª–∂–Ω–æ –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å heartbeat –∫–∞–∂–¥—ã–µ 5-10 –º–∏–Ω—É—Ç
- –ü—Ä–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–∏ —Å–∏–≥–Ω–∞–ª–∞ > 30 –º–∏–Ω—É—Ç –∞–≤—Ç–æ–º–∞—Ç —Å—á–∏—Ç–∞–µ—Ç—Å—è offline

### –¢–µ–ª–µ–º–µ—Ç—Ä–∏—è
- –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –æ—Å—Ç–∞—Ç–∫–æ–≤ —Ç–æ–≤–∞—Ä–æ–≤
- –ö–æ–¥—ã –æ—à–∏–±–æ–∫ –∏ —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ –∞–ª–µ—Ä—Ç–æ–≤

### –ü—Ä–æ–¥–∞–∂–∏
- –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –∫–∞–∂–¥–æ–π –ø—Ä–æ–¥–∞–∂–∏
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –æ—Å—Ç–∞—Ç–∫–æ–≤
- –ö–æ–Ω—Ç—Ä–æ–ª—å –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ —Ç–æ–≤–∞—Ä–æ–≤

## üöÄ –†–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ

### Production Environment

1. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è:
```env
NODE_ENV=production
MONGODB_URI=mongodb+srv://user:pass@cluster.mongodb.net/vending
JWT_SECRET=production-secret-key
```

2. –°–æ–±–µ—Ä–∏—Ç–µ –ø—Ä–æ–µ–∫—Ç:
```bash
yarn build
```

3. –ó–∞–ø—É—Å—Ç–∏—Ç–µ:
```bash
yarn start
```

### Docker

```dockerfile
FROM node:18-alpine
WORKDIR /app
COPY package.json yarn.lock ./
RUN yarn install --frozen-lockfile
COPY . .
RUN yarn build
EXPOSE 3000
CMD ["yarn", "start"]
```

## üß™ –¢–µ—Å—Ç–æ–≤—ã–µ –∞–∫–∫–∞—É–Ω—Ç—ã

–ü–æ—Å–ª–µ –∑–∞–ø—É—Å–∫–∞ `yarn seed`:

- **–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä**: admin@vendingapp.kz / admin123
- **–ú–µ–Ω–µ–¥–∂–µ—Ä 1**: manager1@vendingapp.kz / manager123  
- **–ú–µ–Ω–µ–¥–∂–µ—Ä 2**: manager2@vendingapp.kz / manager456

## üìä –ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è API

### –õ–æ–≥–∏–Ω –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞

```bash
curl -X POST http://localhost:3000/api/auth/login \
  -H "Content-Type: application/json" \
  -d '{"email": "admin@vendingapp.kz", "password": "admin123"}'
```

### –ü–æ–ª—É—á–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ –∞–≤—Ç–æ–º–∞—Ç–æ–≤

```bash
curl -X GET "http://localhost:3000/api/machines?needsRefill=true" \
  -H "Authorization: Bearer YOUR_JWT_TOKEN"
```

### –ù–∞—á–∞–ª–æ –ø–æ–ø–æ–ª–Ω–µ–Ω–∏—è

```bash
curl -X POST http://localhost:3000/api/machines/MACHINE_ID/refill/start \
  -H "Authorization: Bearer YOUR_JWT_TOKEN"
```

### –ó–∞–≤–µ—Ä—à–µ–Ω–∏–µ –ø–æ–ø–æ–ª–Ω–µ–Ω–∏—è

```bash
curl -X POST http://localhost:3000/api/machines/MACHINE_ID/refill/finish \
  -H "Authorization: Bearer YOUR_JWT_TOKEN" \
  -H "Content-Type: application/json" \
  -d '{"added": 200, "comment": "–ü–ª–∞–Ω–æ–≤–æ–µ –ø–æ–ø–æ–ª–Ω–µ–Ω–∏–µ"}'
```

## üîß –ö–æ–º–∞–Ω–¥—ã —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏

```bash
# –ó–∞–ø—É—Å–∫ –≤ —Ä–µ–∂–∏–º–µ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏
yarn dev

# –°–±–æ—Ä–∫–∞ –¥–ª—è production
yarn build

# –ó–∞–ø—É—Å–∫ production —Å–µ—Ä–≤–µ—Ä–∞
yarn start

# –ó–∞–ø–æ–ª–Ω–µ–Ω–∏–µ —Ç–µ—Å—Ç–æ–≤—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏
yarn seed

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –ª–∏–Ω—Ç–µ—Ä–∞
yarn lint
```

## üìà –ë—É–¥—É—â–∏–µ —É–ª—É—á—à–µ–Ω–∏—è

- [ ] WebSocket real-time –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è
- [ ] –ö–∞—Ä—Ç–∞ —Å –≥–µ–æ–ø–æ–∑–∏—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ–º
- [ ] Push —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –¥–ª—è –º–µ–Ω–µ–¥–∂–µ—Ä–æ–≤
- [ ] –†–∞—Å—à–∏—Ä–µ–Ω–Ω–∞—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∞ –ø—Ä–æ–¥–∞–∂
- [ ] –ú–æ–±–∏–ª—å–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –¥–ª—è –ø–æ–∫—É–ø–∞—Ç–µ–ª–µ–π
- [ ] –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –ø–ª–∞—Ç—ë–∂–Ω—ã–º–∏ —Å–∏—Å—Ç–µ–º–∞–º–∏
- [ ] –°–∏—Å—Ç–µ–º–∞ –ª–æ—è–ª—å–Ω–æ—Å—Ç–∏
- [ ] ML –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ –ø–æ—Ç—Ä–µ–±–ª–µ–Ω–∏—è

---

## ü§ù –ü–æ–¥–¥–µ—Ä–∂–∫–∞

–î–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –ø–æ–¥–¥–µ—Ä–∂–∫–∏ –∏–ª–∏ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–π –ø–æ —É–ª—É—á—à–µ–Ω–∏—é —Å–æ–∑–¥–∞–π—Ç–µ issue –≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏ –∏–ª–∏ –æ–±—Ä–∞—Ç–∏—Ç–µ—Å—å –∫ –∫–æ–º–∞–Ω–¥–µ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏.

**MVP v1.0 –≥–æ—Ç–æ–≤ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é! üéâ**